I"‚ﬂ<p><em>Good morning <strong>class</strong>, (see what I did there:P ?)</em>
<em>Today we will discuss a very important subject: creating <strong>pixel art</strong> in <strong>Minecraft</strong> from a given image.</em></p>

<p>¬†</p>

<p>¬†</p>

<p>Ok guys, so I saw people creating <strong>pixel art</strong> in <strong>Minecraft</strong> (trying to render images in the game using blocks) and I really liked the idea. Unfortunately I‚Äôm not good at drawing but I‚Äôm a coder and this will suffice, for now - hopefully this will prove its usefulness for those of you who want to ‚Äúdecorate‚Äù their servers.</p>

<p><u>The program's idea is quite simple:</u> it scans the image pixel by pixel and for each pixel places a block with a similar color in the game, by sending a command (<strong>/setblock X Y Z &lt;block name&gt;</strong>) to the server‚Äôs <strong>InputStream</strong> (no networking stuff, no delay, no headache).</p>

<h2 id="results">Results</h2>

<p>This is what I managed to obtain with this program using a palette of <strong>16 colors</strong>. The coloring is not very accurate since I can‚Äôt produce all the colors in the photos with only 16 types of blocks - however this can be fixed by using more types of blocks.</p>

<figure class="image">
  <img src="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=" data-echo="/imgs/posts/c-minecraft-pixel-art-generator/1.png" alt="Sample #1" />
  <figcaption><p>Sample #1</p>
</figcaption>
</figure>

<figure class="image">
  <img src="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=" data-echo="/imgs/posts/c-minecraft-pixel-art-generator/2.png" alt="Sample #2" />
  <figcaption><p>Sample #2</p>
</figcaption>
</figure>

<figure class="image">
  <img src="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=" data-echo="/imgs/posts/c-minecraft-pixel-art-generator/3.png" alt="Sample #3" />
  <figcaption><p>Sample #3</p>
</figcaption>
</figure>

<figure class="image">
  <img src="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=" data-echo="/imgs/posts/c-minecraft-pixel-art-generator/4.png" alt="Sample #4" />
  <figcaption><p>Sample #4</p>
</figcaption>
</figure>

<figure class="image">
  <img src="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=" data-echo="/imgs/posts/c-minecraft-pixel-art-generator/5.png" alt="Sample #5" />
  <figcaption><p>Sample #5</p>
</figcaption>
</figure>

<figure class="image">
  <img src="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=" data-echo="/imgs/posts/c-minecraft-pixel-art-generator/6.png" alt="Sample #6" />
  <figcaption><p>Sample #6</p>
</figcaption>
</figure>

<figure class="image">
  <img src="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=" data-echo="/imgs/posts/c-minecraft-pixel-art-generator/7.png" alt="Sample #7" />
  <figcaption><p>Sample #7</p>
</figcaption>
</figure>

<h2 id="1-starting-the-server">1. Starting the server</h2>

<p>In order to send commands to your server‚Äôs <strong>InputStream</strong> you need to tweak a few settings at process level. This means you‚Äôll have to start the server from this program, using the <strong>Process</strong> class. Our goal is to make this process read inputs from a custom stream (<strong>Process.StandardInput</strong>) - this stream will be used by our console application to send the set of <strong>/setblock</strong> commands.</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre></td><td class="rouge-code"><pre><span class="c1">// Process mcServerProc = new Process();</span>

<span class="c1">// this must be set to false or the application will throw an exception</span>
<span class="n">mcServerProc</span><span class="p">.</span><span class="n">StartInfo</span><span class="p">.</span><span class="n">UseShellExecute</span> <span class="p">=</span> <span class="k">false</span><span class="p">;</span> 

<span class="c1">// forcing cmd.exe to use Process.StandardInput as input stream </span>
<span class="n">mcServerProc</span><span class="p">.</span><span class="n">StartInfo</span><span class="p">.</span><span class="n">RedirectStandardInput</span> <span class="p">=</span> <span class="k">true</span><span class="p">;</span> 

<span class="c1">// same for these 2 lines - so we can see the server's output</span>
<span class="n">mcServerProc</span><span class="p">.</span><span class="n">StartInfo</span><span class="p">.</span><span class="n">RedirectStandardOutput</span> <span class="p">=</span> <span class="k">true</span><span class="p">;</span> 
<span class="n">mcServerProc</span><span class="p">.</span><span class="n">StartInfo</span><span class="p">.</span><span class="n">RedirectStandardError</span> <span class="p">=</span> <span class="k">true</span><span class="p">;</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>After the input stream was changed, this method can be used to supply information to the process:</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre></td><td class="rouge-code"><pre><span class="n">mcServerProc</span><span class="p">.</span><span class="n">StandardInput</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"command goes here"</span><span class="p">);</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>If you want to display, in your console, any messages that the server sends, you‚Äôll need 2 event handlers (1 for the outputstream and 1 for the errorstream). I wrote them as anonymous functions to keep this sourcecode as short as possible:</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="n">mcServerProc</span><span class="p">.</span><span class="n">OutputDataReceived</span> <span class="p">+=</span> <span class="p">(</span><span class="n">sender</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span> <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">Data</span><span class="p">);</span> <span class="p">};</span>
<span class="n">mcServerProc</span><span class="p">.</span><span class="n">ErrorDataReceived</span> <span class="p">+=</span> <span class="p">(</span><span class="n">sender</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span> <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">Data</span><span class="p">);</span> <span class="p">};</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>After this, you‚Äôll need to call these 2 functions:</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre></td><td class="rouge-code"><pre><span class="n">mcServerProc</span><span class="p">.</span><span class="nf">BeginOutputReadLine</span><span class="p">();</span>
<span class="n">mcServerProc</span><span class="p">.</span><span class="nf">BeginErrorReadLine</span><span class="p">();</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>Basically you‚Äôll start <strong>cmd.exe</strong> from the C# application and from there launch the server by loading the jar file with a line like this:<br />
<strong>java -Xmx1024M -Xms1024M -jar minecraft_server.1.8.8.jar nogui</strong></p>

<p>What you need to be careful about is that once you start the server, your only way to communicate with it is the console - if you close the console, the server will keep running in the background (<strong>java.exe</strong>) and you‚Äôll have to kill the process in order to stop it.</p>

<p>To avoid this make sure you send the command: <strong>stop</strong> before the console closes.</p>

<p>Until now we have something that looks like a primitive wrapper:</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
</pre></td><td class="rouge-code"><pre><span class="k">using</span> <span class="p">(</span><span class="n">Process</span> <span class="n">mcServerProc</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Process</span><span class="p">())</span>
<span class="p">{</span>
    <span class="c1">// path to cmd.exe</span>
    <span class="n">mcServerProc</span><span class="p">.</span><span class="n">StartInfo</span><span class="p">.</span><span class="n">FileName</span> <span class="p">=</span> <span class="n">Path</span><span class="p">.</span><span class="nf">Combine</span><span class="p">(</span><span class="n">Environment</span><span class="p">.</span><span class="n">SystemDirectory</span><span class="p">,</span> <span class="s">"cmd.exe"</span><span class="p">);</span>

    <span class="c1">// path to your minecraft server</span>
    <span class="n">mcServerProc</span><span class="p">.</span><span class="n">StartInfo</span><span class="p">.</span><span class="n">WorkingDirectory</span> <span class="p">=</span> <span class="s">"D:\\mc server"</span><span class="p">;</span> 

    <span class="c1">// bunch of settings, to allow redirection of stdin / stdout / stderr</span>
    <span class="n">mcServerProc</span><span class="p">.</span><span class="n">StartInfo</span><span class="p">.</span><span class="n">UseShellExecute</span> <span class="p">=</span> <span class="k">false</span><span class="p">;</span> <span class="c1">// don't use windows's shell to start this</span>
    <span class="n">mcServerProc</span><span class="p">.</span><span class="n">StartInfo</span><span class="p">.</span><span class="n">RedirectStandardInput</span> <span class="p">=</span> <span class="k">true</span><span class="p">;</span>
    <span class="n">mcServerProc</span><span class="p">.</span><span class="n">StartInfo</span><span class="p">.</span><span class="n">RedirectStandardOutput</span> <span class="p">=</span> <span class="k">true</span><span class="p">;</span>
    <span class="n">mcServerProc</span><span class="p">.</span><span class="n">StartInfo</span><span class="p">.</span><span class="n">RedirectStandardError</span> <span class="p">=</span> <span class="k">true</span><span class="p">;</span>
    <span class="n">mcServerProc</span><span class="p">.</span><span class="n">StartInfo</span><span class="p">.</span><span class="n">CreateNoWindow</span> <span class="p">=</span> <span class="k">true</span><span class="p">;</span>

    <span class="c1">// events used to display stderr and stdout in our console</span>
    <span class="n">mcServerProc</span><span class="p">.</span><span class="n">OutputDataReceived</span> <span class="p">+=</span> <span class="p">(</span><span class="n">sender</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span> <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">Data</span><span class="p">);</span> <span class="p">};</span>
    <span class="n">mcServerProc</span><span class="p">.</span><span class="n">ErrorDataReceived</span> <span class="p">+=</span> <span class="p">(</span><span class="n">sender</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span> <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">Data</span><span class="p">);</span> <span class="p">};</span>

    <span class="c1">// starting cmd.exe</span>
    <span class="n">mcServerProc</span><span class="p">.</span><span class="nf">Start</span><span class="p">();</span>

    <span class="c1">// starts reading form stdout &amp; stderr</span>
    <span class="n">mcServerProc</span><span class="p">.</span><span class="nf">BeginOutputReadLine</span><span class="p">();</span>
    <span class="n">mcServerProc</span><span class="p">.</span><span class="nf">BeginErrorReadLine</span><span class="p">();</span>

    <span class="c1">// launches the server by sending the line between quotes to cmd.exe</span>
    <span class="n">mcServerProc</span><span class="p">.</span><span class="n">StandardInput</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"java -Xmx1024M -Xms1024M -jar minecraft_server.1.8.8.jar nogui"</span><span class="p">);</span>

    <span class="c1">// keeps the command prompt alive until you type 'stop'</span>
    <span class="c1">// otherwise your program will close but the server will keep running</span>
    <span class="c1">// and can only be closed from task manager</span>
    <span class="k">while</span> <span class="p">(</span><span class="k">true</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">Console</span><span class="p">.</span><span class="nf">ReadLine</span><span class="p">().</span><span class="nf">Contains</span><span class="p">(</span><span class="s">"stop"</span><span class="p">))</span>
            <span class="k">break</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="n">mcServerProc</span><span class="p">.</span><span class="n">StandardInput</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"stop"</span><span class="p">);</span> <span class="c1">// stops the server</span>

    <span class="n">Thread</span><span class="p">.</span><span class="nf">Sleep</span><span class="p">(</span><span class="m">3000</span><span class="p">);</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="2-choosing-the-right-block">2. Choosing the right block</h2>

<p>Ok, that was the easy part, believe it or not. We‚Äôll now have to create a list (it‚Äôs actually a <strong>Dictionary</strong>) that contains the name of the available blocks and their colors.</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
</pre></td><td class="rouge-code"><pre><span class="k">static</span> <span class="n">Dictionary</span><span class="p">&lt;</span><span class="n">Color</span><span class="p">,</span> <span class="kt">string</span><span class="p">&gt;</span> <span class="n">colorsDictionary</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Dictionary</span><span class="p">&lt;</span><span class="n">Color</span><span class="p">,</span> <span class="kt">string</span><span class="p">&gt;();</span>

<span class="k">static</span> <span class="k">void</span> <span class="nf">populateDictionary</span><span class="p">()</span>
<span class="p">{</span>
    <span class="n">colorsDictionary</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="n">Color</span><span class="p">.</span><span class="nf">FromArgb</span><span class="p">(</span><span class="m">238</span><span class="p">,</span> <span class="m">238</span><span class="p">,</span> <span class="m">238</span><span class="p">),</span> <span class="s">"wool"</span><span class="p">);</span>
    <span class="n">colorsDictionary</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="n">Color</span><span class="p">.</span><span class="nf">FromArgb</span><span class="p">(</span><span class="m">235</span><span class="p">,</span> <span class="m">131</span><span class="p">,</span> <span class="m">60</span><span class="p">),</span> <span class="s">"wool 1"</span><span class="p">);</span>
    <span class="n">colorsDictionary</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="n">Color</span><span class="p">.</span><span class="nf">FromArgb</span><span class="p">(</span><span class="m">184</span><span class="p">,</span> <span class="m">56</span><span class="p">,</span> <span class="m">195</span><span class="p">),</span> <span class="s">"wool 2"</span><span class="p">);</span>
    <span class="n">colorsDictionary</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="n">Color</span><span class="p">.</span><span class="nf">FromArgb</span><span class="p">(</span><span class="m">111</span><span class="p">,</span> <span class="m">144</span><span class="p">,</span> <span class="m">214</span><span class="p">),</span> <span class="s">"wool 3"</span><span class="p">);</span>
    <span class="n">colorsDictionary</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="n">Color</span><span class="p">.</span><span class="nf">FromArgb</span><span class="p">(</span><span class="m">222</span><span class="p">,</span> <span class="m">207</span><span class="p">,</span> <span class="m">42</span><span class="p">),</span> <span class="s">"wool 4"</span><span class="p">);</span>
    <span class="n">colorsDictionary</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="n">Color</span><span class="p">.</span><span class="nf">FromArgb</span><span class="p">(</span><span class="m">60</span><span class="p">,</span> <span class="m">195</span><span class="p">,</span> <span class="m">48</span><span class="p">),</span> <span class="s">"wool 5"</span><span class="p">);</span>
    <span class="n">colorsDictionary</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="n">Color</span><span class="p">.</span><span class="nf">FromArgb</span><span class="p">(</span><span class="m">219</span><span class="p">,</span> <span class="m">138</span><span class="p">,</span> <span class="m">160</span><span class="p">),</span> <span class="s">"wool 6"</span><span class="p">);</span>
    <span class="n">colorsDictionary</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="n">Color</span><span class="p">.</span><span class="nf">FromArgb</span><span class="p">(</span><span class="m">76</span><span class="p">,</span> <span class="m">76</span><span class="p">,</span> <span class="m">76</span><span class="p">),</span> <span class="s">"wool 7"</span><span class="p">);</span>
    <span class="n">colorsDictionary</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="n">Color</span><span class="p">.</span><span class="nf">FromArgb</span><span class="p">(</span><span class="m">163</span><span class="p">,</span> <span class="m">170</span><span class="p">,</span> <span class="m">170</span><span class="p">),</span> <span class="s">"wool 8"</span><span class="p">);</span>
    <span class="n">colorsDictionary</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="n">Color</span><span class="p">.</span><span class="nf">FromArgb</span><span class="p">(</span><span class="m">45</span><span class="p">,</span> <span class="m">134</span><span class="p">,</span> <span class="m">172</span><span class="p">),</span> <span class="s">"wool 9"</span><span class="p">);</span>
    <span class="n">colorsDictionary</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="n">Color</span><span class="p">.</span><span class="nf">FromArgb</span><span class="p">(</span><span class="m">148</span><span class="p">,</span> <span class="m">77</span><span class="p">,</span> <span class="m">210</span><span class="p">),</span> <span class="s">"wool 10"</span><span class="p">);</span>
    <span class="n">colorsDictionary</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="n">Color</span><span class="p">.</span><span class="nf">FromArgb</span><span class="p">(</span><span class="m">45</span><span class="p">,</span> <span class="m">59</span><span class="p">,</span> <span class="m">178</span><span class="p">),</span> <span class="s">"wool 11"</span><span class="p">);</span>
    <span class="n">colorsDictionary</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="n">Color</span><span class="p">.</span><span class="nf">FromArgb</span><span class="p">(</span><span class="m">90</span><span class="p">,</span> <span class="m">54</span><span class="p">,</span> <span class="m">29</span><span class="p">),</span> <span class="s">"wool 12"</span><span class="p">);</span>
    <span class="n">colorsDictionary</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="n">Color</span><span class="p">.</span><span class="nf">FromArgb</span><span class="p">(</span><span class="m">64</span><span class="p">,</span> <span class="m">89</span><span class="p">,</span> <span class="m">28</span><span class="p">),</span> <span class="s">"wool 13"</span><span class="p">);</span>
    <span class="n">colorsDictionary</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="n">Color</span><span class="p">.</span><span class="nf">FromArgb</span><span class="p">(</span><span class="m">171</span><span class="p">,</span> <span class="m">47</span><span class="p">,</span> <span class="m">42</span><span class="p">),</span> <span class="s">"wool 14"</span><span class="p">);</span>
    <span class="n">colorsDictionary</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="n">Color</span><span class="p">.</span><span class="nf">FromArgb</span><span class="p">(</span><span class="m">14</span><span class="p">,</span> <span class="m">14</span><span class="p">,</span> <span class="m">14</span><span class="p">),</span> <span class="s">"wool 15"</span><span class="p">);</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<p>The next step is to realize that these images contain more than 16 colors so we need a function that takes a pixel‚Äôs color and tells us which color (block) from the list above is the best match.</p>

<p>Our function is based on a method called <strong>k nearest neighbor</strong>: which compares 2 colors and returns an error. The lower the error is the closer the block‚Äôs color is to the original. In our case the formula looks like the euclidean distance between <strong>2 points</strong> in a <strong>3d</strong> space - but instead of coordinates <strong>(X, Y, Z)</strong> we use <strong>(R, G, B)</strong> and the points are actually the colors.</p>

<p><u>For example:</u></p>

<p>if we have a pixel of this color: <strong>P</strong><strong>(R:100 G:100 B:100)</strong> and we have only 2 available blocks: <strong>BlackBlock</strong><strong>(R:0 G:0 B:0)</strong> and <strong>WhiteBlock</strong><strong>(R:255 G:255 B:255)</strong> we compute the errors for each one</p>

<ul>
  <li>Comparing the pixel‚Äôs color to the <strong>BlackBlock</strong>:<br />
<script type="math/tex">error = \sqrt{(100-0)^2 + (100-0)^2 + (100-0)^2)} = 173.2</script></li>
  <li>Now comparing it to the <strong>WhiteBlock</strong>:<br />
<script type="math/tex">error = \sqrt{(100-255)^2 + (100-255)^2 + (100-255)^2} = 268.46</script></li>
</ul>

<p>This means the <strong>BlackBlock</strong> is a better choice as it matches the pixel‚Äôs color better.</p>

<p>The function will look like this (it returns the index of the block):</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
</pre></td><td class="rouge-code"><pre><span class="k">static</span> <span class="kt">int</span> <span class="nf">approximateColor</span><span class="p">(</span><span class="n">Color</span> <span class="n">pixelColor</span><span class="p">)</span>
<span class="p">{</span>
    <span class="kt">double</span> <span class="n">minError</span> <span class="p">=</span> <span class="m">99999</span><span class="p">;</span> <span class="kt">double</span> <span class="n">currentError</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">bestColorIndex</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span>

    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="n">colorsDictionary</span><span class="p">.</span><span class="n">Count</span><span class="p">;</span> <span class="n">i</span><span class="p">++)</span>
    <span class="p">{</span>
        <span class="c1">// gets the color of the block found at index 'i'</span>
        <span class="n">Color</span> <span class="n">blockColor</span> <span class="p">=</span> <span class="n">colorsDictionary</span><span class="p">.</span><span class="nf">ElementAt</span><span class="p">(</span><span class="n">i</span><span class="p">).</span><span class="n">Key</span><span class="p">;</span>

        <span class="c1">// k nearest neighbor</span>
        <span class="n">currentError</span> <span class="p">=</span> <span class="n">Math</span><span class="p">.</span><span class="nf">Sqrt</span><span class="p">(</span><span class="n">Math</span><span class="p">.</span><span class="nf">Pow</span><span class="p">(</span><span class="n">pixelColor</span><span class="p">.</span><span class="n">R</span> <span class="p">-</span> <span class="n">blockColor</span><span class="p">.</span><span class="n">R</span><span class="p">,</span> <span class="m">2</span><span class="p">)</span> <span class="p">+</span> <span class="n">Math</span><span class="p">.</span><span class="nf">Pow</span><span class="p">(</span><span class="n">pixelColor</span><span class="p">.</span><span class="n">G</span> <span class="p">-</span> <span class="n">blockColor</span><span class="p">.</span><span class="n">G</span><span class="p">,</span> <span class="m">2</span><span class="p">)</span> <span class="p">+</span> <span class="n">Math</span><span class="p">.</span><span class="nf">Pow</span><span class="p">(</span><span class="n">pixelColor</span><span class="p">.</span><span class="n">B</span> <span class="p">-</span> <span class="n">blockColor</span><span class="p">.</span><span class="n">B</span><span class="p">,</span> <span class="m">2</span><span class="p">));</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">currentError</span> <span class="p">&lt;</span> <span class="n">minError</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">minError</span> <span class="p">=</span> <span class="n">currentError</span><span class="p">;</span>
            <span class="n">bestColorIndex</span> <span class="p">=</span> <span class="n">i</span><span class="p">;</span>
        <span class="p">}</span>            
    <span class="p">}</span>

    <span class="k">return</span> <span class="n">bestColorIndex</span><span class="p">;</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="3-rendering-the-image-in-game">3. Rendering the image in game</h2>

<p>The last step is constructing the image using blocks; take each pixel of the image, get its color using <strong>GetPixel(x, y)</strong> and run it through the function above to obtain the block that matches the color.</p>

<p>Make sure you include this reference: <strong>System.Drowing.dll</strong>.</p>

<p>Once you have the index of the block, you‚Äôll have to construct a <strong>/setblock</strong> command and send it to the server.</p>

<p><u>small note:</u> you can use <strong>LockBits()</strong> and <strong>UnlockBits()</strong> for efficiency reasons but the server will still limit your speed. In my opinion, it‚Äôs not worth it here.</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
</pre></td><td class="rouge-code"><pre><span class="k">static</span> <span class="k">void</span> <span class="nf">renderImage</span><span class="p">(</span><span class="n">StreamWriter</span> <span class="n">stdin</span><span class="p">,</span> <span class="n">Image</span> <span class="n">img</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">Bitmap</span> <span class="n">bmp</span> <span class="p">=</span> <span class="p">(</span><span class="n">Bitmap</span><span class="p">)</span><span class="n">img</span><span class="p">;</span>

    <span class="c1">// coordinates - from where to start rendering the image (F3 in game)</span>
    <span class="kt">int</span> <span class="n">X</span> <span class="p">=</span> <span class="m">335</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">Y</span> <span class="p">=</span> <span class="m">4</span><span class="p">;</span>
    <span class="kt">int</span> <span class="n">Z</span> <span class="p">=</span> <span class="p">-</span><span class="m">567</span><span class="p">;</span>

    <span class="c1">// rendering the image from the last row of pixels to the first</span>
    <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="n">bmp</span><span class="p">.</span><span class="n">Height</span><span class="p">-</span><span class="m">1</span><span class="p">;</span> <span class="n">i</span> <span class="p">&gt;</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span><span class="p">--)</span>
    <span class="p">{</span>
        <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">j</span> <span class="p">&lt;</span> <span class="n">bmp</span><span class="p">.</span><span class="n">Width</span><span class="p">;</span> <span class="n">j</span><span class="p">++)</span>
        <span class="p">{</span>
            <span class="kt">string</span> <span class="n">cmdTemplate</span> <span class="p">=</span> <span class="n">String</span><span class="p">.</span><span class="nf">Format</span><span class="p">(</span><span class="s">"/setblock {0} {1} {2} "</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">);</span>

            <span class="kt">int</span> <span class="n">bestColorIndex</span> <span class="p">=</span> <span class="nf">approximateColor</span><span class="p">(</span><span class="n">bmp</span><span class="p">.</span><span class="nf">GetPixel</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">));</span>
            <span class="n">stdin</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">cmdTemplate</span> <span class="p">+</span> <span class="n">colorsDictionary</span><span class="p">.</span><span class="nf">ElementAt</span><span class="p">(</span><span class="n">bestColorIndex</span><span class="p">).</span><span class="n">Value</span><span class="p">);</span>
            <span class="n">X</span><span class="p">++;</span>

        <span class="p">}</span>
    <span class="n">Y</span><span class="p">++;</span>
    <span class="n">X</span> <span class="p">-=</span> <span class="n">bmp</span><span class="p">.</span><span class="n">Width</span><span class="p">;</span> 

    <span class="p">}</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>

<h2 id="4-complete-sourcecode">4. Complete Sourcecode</h2>

<p>This is the complete sourcecode - it was made for fun, so don‚Äôt expect it to be really optimized.</p>

<p>Feel free to use / modify it and if you find it interesting or useful, consider sharing this page or dropping a backlink - it <u>helps a lot</u> xD</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
</pre></td><td class="rouge-code"><pre><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Collections.Generic</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Diagnostics</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Drawing</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.IO</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Linq</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Threading</span><span class="p">;</span>

<span class="k">namespace</span> <span class="nn">Minecraft_Drawer</span>
<span class="p">{</span>
    <span class="k">class</span> <span class="nc">Program</span>
    <span class="p">{</span>
        <span class="k">static</span> <span class="n">Dictionary</span><span class="p">&lt;</span><span class="n">Color</span><span class="p">,</span> <span class="kt">string</span><span class="p">&gt;</span> <span class="n">colorsDictionary</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Dictionary</span><span class="p">&lt;</span><span class="n">Color</span><span class="p">,</span> <span class="kt">string</span><span class="p">&gt;();</span>

        <span class="k">static</span> <span class="k">void</span> <span class="nf">populateDictionary</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="n">colorsDictionary</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="n">Color</span><span class="p">.</span><span class="nf">FromArgb</span><span class="p">(</span><span class="m">238</span><span class="p">,</span> <span class="m">238</span><span class="p">,</span> <span class="m">238</span><span class="p">),</span> <span class="s">"wool"</span><span class="p">);</span>
            <span class="n">colorsDictionary</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="n">Color</span><span class="p">.</span><span class="nf">FromArgb</span><span class="p">(</span><span class="m">235</span><span class="p">,</span> <span class="m">131</span><span class="p">,</span> <span class="m">60</span><span class="p">),</span> <span class="s">"wool 1"</span><span class="p">);</span>
            <span class="n">colorsDictionary</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="n">Color</span><span class="p">.</span><span class="nf">FromArgb</span><span class="p">(</span><span class="m">184</span><span class="p">,</span> <span class="m">56</span><span class="p">,</span> <span class="m">195</span><span class="p">),</span> <span class="s">"wool 2"</span><span class="p">);</span>
            <span class="n">colorsDictionary</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="n">Color</span><span class="p">.</span><span class="nf">FromArgb</span><span class="p">(</span><span class="m">111</span><span class="p">,</span> <span class="m">144</span><span class="p">,</span> <span class="m">214</span><span class="p">),</span> <span class="s">"wool 3"</span><span class="p">);</span>
            <span class="n">colorsDictionary</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="n">Color</span><span class="p">.</span><span class="nf">FromArgb</span><span class="p">(</span><span class="m">222</span><span class="p">,</span> <span class="m">207</span><span class="p">,</span> <span class="m">42</span><span class="p">),</span> <span class="s">"wool 4"</span><span class="p">);</span>
            <span class="n">colorsDictionary</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="n">Color</span><span class="p">.</span><span class="nf">FromArgb</span><span class="p">(</span><span class="m">60</span><span class="p">,</span> <span class="m">195</span><span class="p">,</span> <span class="m">48</span><span class="p">),</span> <span class="s">"wool 5"</span><span class="p">);</span>
            <span class="n">colorsDictionary</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="n">Color</span><span class="p">.</span><span class="nf">FromArgb</span><span class="p">(</span><span class="m">219</span><span class="p">,</span> <span class="m">138</span><span class="p">,</span> <span class="m">160</span><span class="p">),</span> <span class="s">"wool 6"</span><span class="p">);</span>
            <span class="n">colorsDictionary</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="n">Color</span><span class="p">.</span><span class="nf">FromArgb</span><span class="p">(</span><span class="m">76</span><span class="p">,</span> <span class="m">76</span><span class="p">,</span> <span class="m">76</span><span class="p">),</span> <span class="s">"wool 7"</span><span class="p">);</span>
            <span class="n">colorsDictionary</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="n">Color</span><span class="p">.</span><span class="nf">FromArgb</span><span class="p">(</span><span class="m">163</span><span class="p">,</span> <span class="m">170</span><span class="p">,</span> <span class="m">170</span><span class="p">),</span> <span class="s">"wool 8"</span><span class="p">);</span>
            <span class="n">colorsDictionary</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="n">Color</span><span class="p">.</span><span class="nf">FromArgb</span><span class="p">(</span><span class="m">45</span><span class="p">,</span> <span class="m">134</span><span class="p">,</span> <span class="m">172</span><span class="p">),</span> <span class="s">"wool 9"</span><span class="p">);</span>
            <span class="n">colorsDictionary</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="n">Color</span><span class="p">.</span><span class="nf">FromArgb</span><span class="p">(</span><span class="m">148</span><span class="p">,</span> <span class="m">77</span><span class="p">,</span> <span class="m">210</span><span class="p">),</span> <span class="s">"wool 10"</span><span class="p">);</span>
            <span class="n">colorsDictionary</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="n">Color</span><span class="p">.</span><span class="nf">FromArgb</span><span class="p">(</span><span class="m">45</span><span class="p">,</span> <span class="m">59</span><span class="p">,</span> <span class="m">178</span><span class="p">),</span> <span class="s">"wool 11"</span><span class="p">);</span>
            <span class="n">colorsDictionary</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="n">Color</span><span class="p">.</span><span class="nf">FromArgb</span><span class="p">(</span><span class="m">90</span><span class="p">,</span> <span class="m">54</span><span class="p">,</span> <span class="m">29</span><span class="p">),</span> <span class="s">"wool 12"</span><span class="p">);</span>
            <span class="n">colorsDictionary</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="n">Color</span><span class="p">.</span><span class="nf">FromArgb</span><span class="p">(</span><span class="m">64</span><span class="p">,</span> <span class="m">89</span><span class="p">,</span> <span class="m">28</span><span class="p">),</span> <span class="s">"wool 13"</span><span class="p">);</span>
            <span class="n">colorsDictionary</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="n">Color</span><span class="p">.</span><span class="nf">FromArgb</span><span class="p">(</span><span class="m">171</span><span class="p">,</span> <span class="m">47</span><span class="p">,</span> <span class="m">42</span><span class="p">),</span> <span class="s">"wool 14"</span><span class="p">);</span>
            <span class="n">colorsDictionary</span><span class="p">.</span><span class="nf">Add</span><span class="p">(</span><span class="n">Color</span><span class="p">.</span><span class="nf">FromArgb</span><span class="p">(</span><span class="m">14</span><span class="p">,</span> <span class="m">14</span><span class="p">,</span> <span class="m">14</span><span class="p">),</span> <span class="s">"wool 15"</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="c1">// gets the closest available color (decides what block color should be used for a pixel)</span>
        <span class="k">static</span> <span class="kt">int</span> <span class="nf">approximateColor</span><span class="p">(</span><span class="n">Color</span> <span class="n">pixelColor</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="kt">double</span> <span class="n">minError</span> <span class="p">=</span> <span class="m">99999</span><span class="p">;</span> <span class="kt">double</span> <span class="n">currentError</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span>
            <span class="kt">int</span> <span class="n">bestColorIndex</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span>

            <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="n">colorsDictionary</span><span class="p">.</span><span class="n">Count</span><span class="p">;</span> <span class="n">i</span><span class="p">++)</span>
            <span class="p">{</span>
                <span class="n">Color</span> <span class="n">blockColor</span> <span class="p">=</span> <span class="n">colorsDictionary</span><span class="p">.</span><span class="nf">ElementAt</span><span class="p">(</span><span class="n">i</span><span class="p">).</span><span class="n">Key</span><span class="p">;</span>

                <span class="c1">// k nearest neighbor</span>
                <span class="n">currentError</span> <span class="p">=</span> <span class="n">Math</span><span class="p">.</span><span class="nf">Sqrt</span><span class="p">(</span><span class="n">Math</span><span class="p">.</span><span class="nf">Pow</span><span class="p">(</span><span class="n">pixelColor</span><span class="p">.</span><span class="n">R</span> <span class="p">-</span> <span class="n">blockColor</span><span class="p">.</span><span class="n">R</span><span class="p">,</span> <span class="m">2</span><span class="p">)</span> <span class="p">+</span> <span class="n">Math</span><span class="p">.</span><span class="nf">Pow</span><span class="p">(</span><span class="n">pixelColor</span><span class="p">.</span><span class="n">G</span> <span class="p">-</span> <span class="n">blockColor</span><span class="p">.</span><span class="n">G</span><span class="p">,</span> <span class="m">2</span><span class="p">)</span> <span class="p">+</span> <span class="n">Math</span><span class="p">.</span><span class="nf">Pow</span><span class="p">(</span><span class="n">pixelColor</span><span class="p">.</span><span class="n">B</span> <span class="p">-</span> <span class="n">blockColor</span><span class="p">.</span><span class="n">B</span><span class="p">,</span> <span class="m">2</span><span class="p">));</span>

                <span class="k">if</span> <span class="p">(</span><span class="n">currentError</span> <span class="p">&lt;</span> <span class="n">minError</span><span class="p">)</span>
                <span class="p">{</span>
                    <span class="n">minError</span> <span class="p">=</span> <span class="n">currentError</span><span class="p">;</span>
                    <span class="n">bestColorIndex</span> <span class="p">=</span> <span class="n">i</span><span class="p">;</span>
                <span class="p">}</span>

            <span class="p">}</span>

            <span class="k">return</span> <span class="n">bestColorIndex</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="k">static</span> <span class="k">void</span> <span class="nf">renderImage</span><span class="p">(</span><span class="n">StreamWriter</span> <span class="n">stdin</span><span class="p">,</span> <span class="n">Image</span> <span class="n">img</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">Bitmap</span> <span class="n">bmp</span> <span class="p">=</span> <span class="p">(</span><span class="n">Bitmap</span><span class="p">)</span><span class="n">img</span><span class="p">;</span>

            <span class="c1">// coordinates - from where to start rendering the image</span>
            <span class="kt">int</span> <span class="n">X</span> <span class="p">=</span> <span class="m">335</span><span class="p">;</span>
            <span class="kt">int</span> <span class="n">Y</span> <span class="p">=</span> <span class="m">4</span><span class="p">;</span>
            <span class="kt">int</span> <span class="n">Z</span> <span class="p">=</span> <span class="p">-</span><span class="m">567</span><span class="p">;</span>

            <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="n">bmp</span><span class="p">.</span><span class="n">Height</span><span class="p">-</span><span class="m">1</span><span class="p">;</span> <span class="n">i</span> <span class="p">&gt;</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span><span class="p">--)</span>
            <span class="p">{</span>
                <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">j</span> <span class="p">&lt;</span> <span class="n">bmp</span><span class="p">.</span><span class="n">Width</span><span class="p">;</span> <span class="n">j</span><span class="p">++)</span>
                <span class="p">{</span>
                    <span class="kt">string</span> <span class="n">cmdTemplate</span> <span class="p">=</span> <span class="n">String</span><span class="p">.</span><span class="nf">Format</span><span class="p">(</span><span class="s">"/setblock {0} {1} {2} "</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">);</span>

                    <span class="kt">int</span> <span class="n">bestColorIndex</span> <span class="p">=</span> <span class="nf">approximateColor</span><span class="p">(</span><span class="n">bmp</span><span class="p">.</span><span class="nf">GetPixel</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">i</span><span class="p">));</span>
                    <span class="n">stdin</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">cmdTemplate</span> <span class="p">+</span> <span class="n">colorsDictionary</span><span class="p">.</span><span class="nf">ElementAt</span><span class="p">(</span><span class="n">bestColorIndex</span><span class="p">).</span><span class="n">Value</span><span class="p">);</span>
                    <span class="n">X</span><span class="p">++;</span>

                <span class="p">}</span>
                <span class="n">Y</span><span class="p">++;</span>
                <span class="n">X</span> <span class="p">-=</span> <span class="n">bmp</span><span class="p">.</span><span class="n">Width</span><span class="p">;</span> 

            <span class="p">}</span>
        <span class="p">}</span>

        <span class="k">static</span> <span class="k">void</span> <span class="nf">Main</span><span class="p">(</span><span class="kt">string</span><span class="p">[]</span> <span class="n">args</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">using</span> <span class="p">(</span><span class="n">Process</span> <span class="n">mcServerProc</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Process</span><span class="p">())</span>
            <span class="p">{</span>
                <span class="c1">// path to cmd.exe</span>
                <span class="n">mcServerProc</span><span class="p">.</span><span class="n">StartInfo</span><span class="p">.</span><span class="n">FileName</span> <span class="p">=</span> <span class="n">Path</span><span class="p">.</span><span class="nf">Combine</span><span class="p">(</span><span class="n">Environment</span><span class="p">.</span><span class="n">SystemDirectory</span><span class="p">,</span> <span class="s">"cmd.exe"</span><span class="p">);</span>

                <span class="c1">// path to your minecraft server</span>
                <span class="n">mcServerProc</span><span class="p">.</span><span class="n">StartInfo</span><span class="p">.</span><span class="n">WorkingDirectory</span> <span class="p">=</span> <span class="s">"D:\\mc server"</span><span class="p">;</span> 

                <span class="c1">// bunch of settings, to allow redirection of stdin / stdout / stderr</span>
                <span class="n">mcServerProc</span><span class="p">.</span><span class="n">StartInfo</span><span class="p">.</span><span class="n">UseShellExecute</span> <span class="p">=</span> <span class="k">false</span><span class="p">;</span>
                <span class="n">mcServerProc</span><span class="p">.</span><span class="n">StartInfo</span><span class="p">.</span><span class="n">RedirectStandardInput</span> <span class="p">=</span> <span class="k">true</span><span class="p">;</span>
                <span class="n">mcServerProc</span><span class="p">.</span><span class="n">StartInfo</span><span class="p">.</span><span class="n">RedirectStandardOutput</span> <span class="p">=</span> <span class="k">true</span><span class="p">;</span>
                <span class="n">mcServerProc</span><span class="p">.</span><span class="n">StartInfo</span><span class="p">.</span><span class="n">RedirectStandardError</span> <span class="p">=</span> <span class="k">true</span><span class="p">;</span>
                <span class="n">mcServerProc</span><span class="p">.</span><span class="n">StartInfo</span><span class="p">.</span><span class="n">CreateNoWindow</span> <span class="p">=</span> <span class="k">true</span><span class="p">;</span>

                <span class="c1">// displaying stderr and stdout in our console</span>
                <span class="n">mcServerProc</span><span class="p">.</span><span class="n">OutputDataReceived</span> <span class="p">+=</span> <span class="p">(</span><span class="n">sender</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span> <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">Data</span><span class="p">);</span> <span class="p">};</span>
                <span class="n">mcServerProc</span><span class="p">.</span><span class="n">ErrorDataReceived</span> <span class="p">+=</span> <span class="p">(</span><span class="n">sender</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span> <span class="p">=&gt;</span> <span class="p">{</span> <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">e</span><span class="p">.</span><span class="n">Data</span><span class="p">);</span> <span class="p">};</span>

                <span class="n">mcServerProc</span><span class="p">.</span><span class="nf">Start</span><span class="p">();</span>

                <span class="c1">// starts reading form stdout &amp; stderr</span>
                <span class="n">mcServerProc</span><span class="p">.</span><span class="nf">BeginOutputReadLine</span><span class="p">();</span>
                <span class="n">mcServerProc</span><span class="p">.</span><span class="nf">BeginErrorReadLine</span><span class="p">();</span>

                <span class="c1">// writes to the command prompt (cm d.exe) the line to execute the jar file (start the server)</span>
                <span class="n">mcServerProc</span><span class="p">.</span><span class="n">StandardInput</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"java -Xmx1024M -Xms1024M -jar minecraft_server.1.8.8.jar nogui"</span><span class="p">);</span>

                <span class="n">Thread</span><span class="p">.</span><span class="nf">Sleep</span><span class="p">(</span><span class="m">15000</span><span class="p">);</span> <span class="c1">// waiting for server to start</span>

                <span class="c1">// adds available blocks and their colors to the dictionary</span>
                <span class="nf">populateDictionary</span><span class="p">();</span>

                <span class="c1">// renders an image in the game</span>
                <span class="nf">renderImage</span><span class="p">(</span><span class="n">mcServerProc</span><span class="p">.</span><span class="n">StandardInput</span><span class="p">,</span> <span class="n">Image</span><span class="p">.</span><span class="nf">FromFile</span><span class="p">(</span><span class="s">"randomPhoto.png"</span><span class="p">));</span>

                <span class="c1">// keeps the command prompt alive until you type 'stop'</span>
                <span class="c1">// otherwise this will close and the server keeps running</span>
                <span class="k">while</span> <span class="p">(</span><span class="k">true</span><span class="p">)</span>
                <span class="p">{</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">Console</span><span class="p">.</span><span class="nf">ReadLine</span><span class="p">().</span><span class="nf">Contains</span><span class="p">(</span><span class="s">"stop"</span><span class="p">))</span>
                        <span class="k">break</span><span class="p">;</span>
                <span class="p">}</span>

                <span class="n">mcServerProc</span><span class="p">.</span><span class="n">StandardInput</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"stop"</span><span class="p">);</span> <span class="c1">// stops the server</span>

                <span class="n">Thread</span><span class="p">.</span><span class="nf">Sleep</span><span class="p">(</span><span class="m">3000</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></td></tr></tbody></table></code></pre></div></div>
:ET